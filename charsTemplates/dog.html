<body onload="loadSite()">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<a href="/">Go Home</a><br>

<p id ="descriptionSec">
    
    <b>Old Sea Dog</b>
    <br>
    Many  a  year  ago,  before  you  were  a  sailor...     actually,  you're  not  really  sure  what
    you  did  before  you  left  for  the  sea.  You  were  barely  past  a  child  when  you served
    aboard your first ship. Now, having seen hundreds of storms, and survived  only  by  the  sea's  good  grace,
    you  are  a  wealth  of  knowledge  and  superstition  What you've seen from vessels' decks many men would not
    think real. You've stared at the sea so long you can read its very moods and emotions â€“ and you're fairly sure it is staring back.
    <br>
    <br>
    
    <b>The Sea Speaks</b><br>When you handle or examine something interesting from the sea, <b>ROLL+BEYOND</b><br>
    <b>ON A 10+</b>: Ask 3<br>
    <b>ON A 7-9</b>: Ask 1<br>
    Who handled this before me?<br>
    Who made this?<br>
    What strong emotions have been recently near this?<br>
    What words have been said recently near this?<br>
    What has been done recently with this or to this?<br>
    <b>ON A MISS</b>: The GM makes things worse.
    
    
    
    <br>
    <input type="submit" value="Next" onclick="submitFunc()" id="appearanceButton">
    
</p>

<p id="nameAppearanceSec">

     

    <style type="text/css">
    .tg  {border-collapse:collapse;border-spacing:0;}
    .tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
      overflow:hidden;padding:10px 5px;word-break:normal;}
    .tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
      font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
    .tg .tg-c3ow{border-color:inherit;text-align:center;vertical-align:top}
    </style>
    <table class="tg">
    <thead>
      <tr>
        <th class="tg-c3ow">Name</th>
        <th class="tg-c3ow" colspan="4"><input type="text" id="charName" name="charName" value="" autocomplete="off" onkeyup="extractText(this.value, this.id)"><br></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="tg-c3ow" colspan="5">Appearance</td>
      </tr>
      <tr>
        <td class="tg-c3ow">Gender</td>
        <td class="tg-0pky"><input type="radio" id="male" name="gender" value="male" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="male">Male</label></td>
        <td class="tg-0pky"><input type="radio" id="female" name="gender" value="female" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="female">Female</label></td>
        <td class="tg-0pky"><input type="radio" id="nonbinary" name="gender" value="nonbinary" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="nonbinary">Nonbinary</label></td>
        <td class="tg-0pky"></td>
      </tr>
      <tr>
        <td class="tg-c3ow">Eyes</td>
        <td class="tg-0pky"><input type="radio" id="glittering" name="eyes" value="glittering" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="glittering">Glittering</label></td>
        <td class="tg-0pky"><input type="radio" id="languid" name="eyes" value="languid" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="languid">Languid</label></td>
        <td class="tg-0pky"><input type="radio" id="mysterious" name="eyes" value="mysterious" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="mysterious">Mysterious</label></td>
        <td class="tg-0pky"><input type="radio" id="suspicious" name="eyes" value="suspicious" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="suspicious">Suspicious</label></td>
      </tr>
      <tr>
        <td class="tg-c3ow">Face</td>
        <td class="tg-0pky"><input type="radio" id="weathered" name="face" value="weathered" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="weathered">Weathered</label></td>
        <td class="tg-0pky"><input type="radio" id="ascetic" name="face" value="ascetic" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="ascetic">Ascetic</label></td>
        <td class="tg-0pky"><input type="radio" id="expressive" name="face" value="expressive" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="expressive">Expressive</label></td>
        <td class="tg-0pky"><input type="radio" id="mesmerizing" name="face" value="mesmerizing" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="mesmerizing">Mesmerizing</label></td>
      </tr>
      <tr>
        <td class="tg-c3ow">Body</td>
        <td class="tg-0pky"><input type="radio" id="bony" name="body" value="bony" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="bony">Bony</label></td>
        <td class="tg-0pky"><input type="radio" id="sinewy" name="body" value="sinewy" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="sinewy">Sinewy</label></td>
        <td class="tg-0pky"><input type="radio" id="solid" name="body" value="solid" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="solid">Solid</label></td>
      </tr>
      <tr>
        <td class="tg-c3ow">Dress</td>
        <td class="tg-0pky"><input type="radio" id="garb" name="dress" value="garb" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="garb">Old sailor's garb and cap</label></td>
        <td class="tg-0pky"><input type="radio" id="outfit" name="dress" value="outfit" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="outfit">Tattered whailer's outfit</label></td>
        <td class="tg-0pky"><input type="radio" id="suspenders" name="dress" value="suspenders" onclick="appearanceSel(this.id, this.name)" autocomplete="off">
        <label for="suspenders">Suspenders over a stained shirt</label></td>
        <td class="tg-0pky"></td>
      </tr>
    </tbody>
    </table>
    <br>
        <input type="submit" value="Next" onclick="submitFunc()" id="appearanceButton">
        

        
        

</p>

<p id="statsSec">
        
    <style type="text/css">
    .tg  {border-collapse:collapse;border-spacing:0;}
    .tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
      overflow:hidden;padding:10px 5px;word-break:normal;}
    .tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
      font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
    .tg .tg-wp8o{border-color:#000000;text-align:center;vertical-align:top}
    </style>
    <table class="tg">
    <thead>
      <tr>
        <th class="tg-wp8o" colspan="2">Stats</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="tg-wp8o">Brains</td>
        <td class="tg-wp8o">
        <!-- <td class="tg-wp8o">+2</td> -->
        <input type="text" id="brains" name="brains" value="" autocomplete="off" onkeyup="extractText(this.value, this.id)"></td>
      </tr>
      <tr>
        <td class="tg-wp8o">Brawn</td>
        <!-- <td class="tg-wp8o">+2</td> -->
        <td class="tg-wp8o"><input type="text" id="brawn" name="brawn" value="" autocomplete="off" onkeyup="extractText(this.value, this.id)"></td>
      </tr>
      <tr>
        <td class="tg-wp8o">Beauty</td>
        <!-- <td class="tg-wp8o">+2</td> -->
        <td class="tg-wp8o"><input type="text" id="beauty" name="beauty" value="" autocomplete="off" onkeyup="extractText(this.value, this.id)"></td>
      </tr>
      <tr>
        <td class="tg-wp8o">Balance</td>   
        <!-- <td class="tg-wp8o">+2</td>         -->
        <td class="tg-wp8o"><input type="text" id="balance" name="balance" value="" autocomplete="off" onkeyup="extractText(this.value, this.id)"></td>
      </tr>
      <tr>
        <td class="tg-wp8o">Beyond</td>
        <td class="tg-wp8o">+2</td>
        <!-- <td class="tg-wp8o"><input type="text" id="beyond" name="beyond" value="" autocomplete="off" onkeyup="extractText(this.value, this.id)"></td> -->
      </tr>
    </tbody>
    </table>
    <br>
    
    
    <input type="submit" value="Next" onclick="submitFunc()" id="statsButton">
    <p style="color:red" id="statsWarning"><b>You did not allocate properly</b></p>
    
</p>

<p id="bondsSec">
        Bonds
        <br>
        <br>
        You've taught 
        <input type="text" id="bondOne" name="bondOne" value="" autocomplete="off" onkeyup="extractText(this.value, this.id)"> everything they know about the sea.
        <br>
        <br>
        <input type="text" id="bondTwo" name="bondTwo" value="" autocomplete="off" onkeyup="extractText(this.value, this.id)"> are too impulsive. They are
        dangerous to be around.
        <br>
        <br> 
        You know that
        <input type="text" id="bondThree" name="bondThree" value="" autocomplete="off" onkeyup="extractText(this.value, this.id)"> hears the sounds at night as well.
        <br>
        <br>
        <input type="text" id="bondFour" name="bondFour" autocomplete="off" onkeyup="extractText(this.value, this.id)">'s parents made you promise to keep them safe
        on this journey.
        <br>
        <br>
        <input type="submit" value="Next" onclick="submitFunc()" id="bondsButton">
        
        
        
</p>


</body>

<script>

var section = 0;
var sectionList = ["descriptionSec","nameAppearanceSec", "statsSec", "bondsSec"];
                        
let attributesDict = {'charName':'', 'gender':'', 'eyes':'', 'face':'', 'body':'', 'dress':'',
                        'brains':0, 'brawn':0, 'beauty':0, 'balance':0, 'beyond':2, 'bondOne':'',
                        'bondTwo':'', 'bondThree':'', 'bondFour':'', 'health':4,
                        'specialMove':'<b>The Sea Speaks</b><br>When you handle or examine something interesting from the sea, <b>ROLL+BEYOND</b><br>'+
                        '<b>ON A 10+</b>: Ask 3<br>' +
                        '<b>ON A 7-9</b>: Ask 1<br>'+
                        'Who handled this before me?<br>'+
                        'Who made this?<br>'+
                        'What strong emotions have been recently near this?<br>'+
                        'What words have been said recently near this?<br>'+
                        'What has been done recently with this or to this?<br>'+
                        '<b>ON A MISS</b>: The GM makes things worse.',
                        'equipment':'An old trinket<br>'+
                        'Sturdy cloth vest (1 armour)<br>' + 
                        'A Sailor\'s wage (Choose 1:destitute, average)<br>'};

function loadSite()
{
    sectionList.forEach(function (item, index) {
        if (item != "descriptionSec")
        {
            document.getElementById(item).style.display = "none";
        }
    });
    document.getElementById('statsWarning').style.display = "none";

}

function submitFunc()
{     
    if (section >= sectionList.length - 1)
    {
        section = sectionList.length - 1;
        sendData();
        
    }
    else if (sectionList[section] == 'statsSec')
    {
        let statsSum = attributesDict['brains'] + attributesDict['brawn'] + attributesDict['beauty'];
        statsSum = statsSum + attributesDict['balance'] + attributesDict['beyond'];        
        if (statsSum == 3)
        {
            
            document.getElementById('statsWarning').style.display = "none";
            document.getElementById(sectionList[section]).style.display = "none";
            section++;
            document.getElementById(sectionList[section]).style.display = "block";
        }
        else
            document.getElementById('statsWarning').style.display = "block";
        
    
    }
    else
    {
        document.getElementById(sectionList[section]).style.display = "none";
        section++;
        document.getElementById(sectionList[section]).style.display = "block";
    }
    
}

function sendData()
{
    console.log("send");
    console.log(attributesDict);
    
    
    console.log(attributesDict);
    
    let xhr = new XMLHttpRequest(); 
    let url = "characterSave?char=dog";

    // open a connection 
    xhr.open("POST", url, true); 

    // Set the request header i.e. which type of content you are sending 
    xhr.setRequestHeader("Content-Type", "application/json"); 

    // Create a state change callback 
    
    xhr.onreadystatechange = function () { 
        if (xhr.readyState === 4 && xhr.status === 200) { 

            // Print received data from server 
            //result.innerHTML = this.responseText;
            //console.log(this.responseText);
            if (this.responseText == 'ok')
                window.location.replace("characterEx?char=dog");            
            else if(this.responseText == 'bad')
            {
                alert('This character already exists, please pick a different one');
                window.location.replace("/");  
            }

        } 
    }; 

    console.log(attributesDict);
    // Converting JSON data to string 
    var data = JSON.stringify(attributesDict); 

    // Sending data with the request 
    xhr.send(data);
    
}

function extractText(text, id)
{
    if (id == 'brains' || id == 'brawn' || id == 'beauty' || id == 'balance' || id == 'beyond')
        attributesDict[id] = parseInt(text);
    else if (id == 'bondOne')
        attributesDict[id] = 'You\'ve taught <b>' + text + '</b> everything they know about the sea.';
    else if (id == 'bondTwo')
        attributesDict[id] = '<b>' + text + '</b> are too impulsive. They are dangerous to be around.';
    else if (id == 'bondThree')
        attributesDict[id] = 'You know that <b>' + text + '</b> hears the sounds at night as well.';
    else if (id == 'bondFour')
        attributesDict[id] = '<b>' + text + '</b>\'s parents made you promise to keep them safe on this journey.';
    else
        attributesDict[id] = text;

}

function appearanceSel(id, name)
{
    if (name == 'gender')
        attributesDict['gender'] = id.charAt(0).toUpperCase() + id.slice(1);
    else if (name == 'eyes')
        attributesDict['eyes'] = id.charAt(0).toUpperCase() + id.slice(1);
    else if (name == 'face')
        attributesDict['face'] = id.charAt(0).toUpperCase() + id.slice(1);
    else if (name == 'body')
        attributesDict['body'] = id.charAt(0).toUpperCase() + id.slice(1);
    else if (name == 'dress')
    {
        if (id == 'garb')
            attributesDict['dress'] = 'Old sailor\'s garb and cap';
        if (id == 'outfit')
            attributesDict['dress'] = 'Tattered whailer\'s outfit';
        if (id == 'suspenders')
            attributesDict['dress'] = 'Suspenders over a stained shirt';
    }
    else
        console.log("appearance went wrong");
    
}

</script>